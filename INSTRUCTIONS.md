# Інструкція з налаштування збереження даних в Google Sheets

## Крок 1: Створення Google Apps Script Web App

1. Відкрийте [Google Apps Script](https://script.google.com)
2. Натисніть "Новий проект"
3. Скопіюйте код з файлу `google-apps-script.js` в редактор
4. Переконайтеся, що `SPREADSHEET_ID` встановлено правильно (вже встановлено в коді)
5. Збережіть проект (Ctrl+S або Cmd+S)
6. Дайте проекту назву, наприклад: "Border Crossing Web App"

## Крок 2: Розгортання Web App

1. Натисніть "Розгорнути" → "Нове розгортання"
2. Натисніть на іконку налаштувань (⚙️) поруч з "Тип"
3. Виберіть "Веб-додаток"
4. Заповніть поля:
   - **Опис**: "Web App for saving border crossing selections"
   - **Виконувати як**: "Я" (ваш email)
   - **Хто має доступ**: "Усі"
5. Натисніть "Розгорнути"
6. **ВАЖЛИВО**: При першому розгортанні вам потрібно надати дозволи:
   - Натисніть "Авторизувати доступ"
   - Виберіть ваш Google акаунт
   - Натисніть "Просунутий" → "Перейти до [назва проекту] (небезпечно)"
   - Натисніть "Дозволити"
7. Скопіюйте **URL Web App** (він буде показаний після розгортання)

## Крок 3: Налаштування в script.js

1. Відкрийте файл `script.js`
2. Знайдіть рядок: `const WEB_APP_URL = '';`
3. Вставте скопійований URL Web App між лапками:
   ```javascript
   const WEB_APP_URL = 'https://script.google.com/macros/s/YOUR_WEB_APP_ID/exec';
   ```

## Крок 4: Перевірка роботи

1. Відкрийте `index.html` в браузері
2. Виберіть напрямок зі списку
3. Перевірте, чи з'явився індикатор "(збереження...)" та потім "✓"
4. Відкрийте Google Sheets таблицю
5. Перейдіть на аркуш "Border"
6. Переконайтеся, що новий рядок з датою/часом та напрямком додано

## Структура аркуша "Border"

Аркуш "Border" автоматично створюється при першому збереженні з такими стовпцями:
- **A1**: Дата/Час
- **B1**: Напрямок

## Примітки

- Якщо аркуш "Border" не існує, він буде створено автоматично
- Дані зберігаються автоматично при виборі напрямку
- Кожен вибір зберігається як окремий рядок з датою/часом
- Якщо Web App URL не налаштовано, збереження не відбувається (без помилок)

## Усунення проблем

### Помилка "Web App URL не налаштовано"
- Переконайтеся, що ви вставили URL в `WEB_APP_URL` в `script.js`

### Помилка авторизації
- Переконайтеся, що ви надали всі необхідні дозволи при розгортанні Web App

### Дані не зберігаються
- Перевірте консоль браузера (F12) на наявність помилок
- Переконайтеся, що Web App розгорнуто з доступом "Усі"
- Перевірте, чи правильно встановлено `SPREADSHEET_ID` в Google Apps Script

